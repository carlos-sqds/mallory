# Test: New User Signup Flow
# Tests the complete onboarding flow for a first-time user
# 
# Prerequisites:
# - App is not logged in
# - Test user has never signed up before (or has been deleted)
#
# Expected behavior:
# 1. User clicks "Continue with Google"
# 2. OAuth completes (external)
# 3. Grid OTP modal appears (new user needs to verify)
# 4. User enters OTP and completes signup
# 5. User lands on chat screen

appId: ${APP_ID}
tags:
  - auth
  - critical
  - new-user

---

# Step 1: Verify we're on login screen
- assertVisible: "Continue with Google"
- assertNotVisible: "Chat"

# Step 2: Start sign-in flow
- tapOn: "Continue with Google"
- waitForAnimationToEnd:
    timeout: ${TIMEOUT_LONG}

# Step 3: OAuth redirect (happens externally, we wait for return)
# After OAuth, app should show Grid OTP modal for new users
- assertVisible:
    text: "Enter verification code"
    timeout: ${TIMEOUT_LONG}

# Step 4: Complete Grid OTP verification
- inputText: "${TEST_GRID_OTP}"
- tapOn: "Verify"
- waitForAnimationToEnd:
    timeout: ${TIMEOUT_MEDIUM}

# Step 5: Verify successful login
# New users may see onboarding or go straight to chat
- assertVisible:
    text: "(Welcome|Chat|New conversation)"
    timeout: ${TIMEOUT_MEDIUM}

# Step 6: Verify we're NOT on login screen
- assertNotVisible: "Continue with Google"

# SUCCESS: New user has completed signup!

